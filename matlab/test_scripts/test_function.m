function [z, J] = test_function(v)

x = v(1);
y = v(2);

z = 3*(1-x).^2.*exp(-(x.^2) - (y+1).^2) ... 
   - 10*(x/5 - x.^3 - y.^5).*exp(-x.^2-y.^2) ... 
   - 1/3*exp(-(x+1).^2 - y.^2) + 8;

if nargout > 1
    J = [ (exp(- (x + 1)^2 - y^2)*(2*x + 2))/3 + 3*exp(- (y + 1)^2 - x^2)*(2*x - 2) + exp(- x^2 - y^2)*(30*x^2 - 2) - 6*x*exp(- (y + 1)^2 - x^2)*(x - 1)^2 - 2*x*exp(- x^2 - y^2)*(10*x^3 - 2*x + 10*y^5), ...
          (2*y*exp(- (x + 1)^2 - y^2))/3 + 50*y^4*exp(- x^2 - y^2) - 3*exp(- (y + 1)^2 - x^2)*(2*y + 2)*(x - 1)^2 - 2*y*exp(- x^2 - y^2)*(10*x^3 - 2*x + 10*y^5) ];
end

end