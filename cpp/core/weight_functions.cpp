#include "weight_functions.h"

///////////////////////////////////////////////////////////////////////////////
Eigen::VectorXf ErrorWeightFunction::operator()(const Eigen::VectorXf& x) const
{
    Eigen::VectorXf out(x.size());

    for (int i = 0; i < x.size(); i++)
        out(i) = (*this)(x(i));

    return out;
}
///////////////////////////////////////////////////////////////////////////////
void ErrorWeightFunction::apply(Eigen::VectorXf& x)
{
    for (int i = 0; i < x.size(); i++)
        x(i) = (*this)(x(i));
}
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
float ErrorWeightHuber::operator()(float x) const
{
    float a = x; // abs(x)
    if (a < 0)
        a = -a;

    if (a <= delta) {
        return 0.5 * x * x;
    } else {
        return (a - delta/2) * delta;
    }
}
///////////////////////////////////////////////////////////////////////////////
